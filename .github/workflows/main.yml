name: Verify and Deploy
on:
  pull_request_target:
    types:
      - closed
permissions:
  checks: write
  id-token: write   # This is required for requesting the JWT
  contents: read    # This is required for actions/checkout
env:
  AWS_REGION : "us-east-1"
  AWS_REGION_ZONE : "us-east-1"  
jobs:
  deploy:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: configure aws credentials
        uses: aws-actions/configure-aws-credentials@v1
        with:
          role-to-assume: arn:aws:iam::172017021075:role/GithubWorkFlowRole
          role-session-name: githubworkflowrolesessiont2
          aws-region: ${{ env.AWS_REGION }}
      - name: Deploy to S3
        uses: aws-actions/s3-deploy@v1
        with:
          args: --acl public-read --follow-symlinks --delete
          local-dir: ./
          bucket: amazon-cloudfront-secure-static-site-s3bucketroot-14oliw5cmta06
